version: 1
description: Rules for Kubernetes spec files
type: Kubernetes
files:
  - "*.yml"
rules:

  - id: SERVICE_TYPE
    severity: FAILURE
    message: Service should not have NodePort
    resource: Pod
    assertions:
      - key: spec.type
        op: eq
        value: NodePort
    tags:
      - pod
      - policy
